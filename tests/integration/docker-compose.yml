version: "3"

services:
    omnicore:
        image:
            johng12345/omnicore:latest
        volumes:
            - ${PWD}/tests/integration/bitcoin.conf:/root/bitcoin.conf
        expose:
            - "18444"

    omnibolt:
        volumes:
            - ${PWD}/tests/integration/conf.ini.bob:/obd/conf.ini.bob
            - ${PWD}/tests/integration/conf.ini.alice:/obd/conf.ini.alice
        build:
            context: ../..
            dockerfile: ./tests/integration/omnibolt.Dockerfile

        expose:
            - 4002
            - 4001
            - 60020
            - 60021
            - 60080
            - 60060
            - 50050
            - 50051
        depends_on:
            - omnicore
    omnitest:
        build: 
            context: .
            dockerfile: Dockerfile
        depends_on: 
            - omnibolt
            - omnicore

